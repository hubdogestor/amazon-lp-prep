import{j as e,u as t,H as s}from"./index-Y0fs9fSm.js";import{r as a}from"./react-VIAh7PwP.js";import{i as r}from"./data-utils-P2Ocme3_.js";import{C as l,a as i}from"./icons-_3dDKlQ4.js";import"./data-core-qUGV2W61.js";import"./hooks-CiGDHzib.js";import"./utils-4AxJaYow.js";function n({narrative:t,language:s,onClose:r,isUsed:n=!1,onToggleUsed:o}){const d=a.useRef(null);if(a.useEffect(()=>{var e;null==(e=d.current)||e.focus()},[t]),!t||!t.version)return null;const{sectionTitle:c,sectionCategory:x,version:g}=t,h="pt"===s?"Contexto sugerido":"Suggested context",m="pt"===s?"Gancho":"Hook",u="pt"===s?"Fecho":"Mic Drop",p="pt"===s?"Temas":"Tags",b="pt"===s?"Fechar":"Close",f=n?"pt"===s?"Remover marca de narrativa usada":"Unmark icebreaker as used":"pt"===s?"Marcar narrativa como usada":"Mark icebreaker as used",j=n?"line-through decoration-slate-300 text-gray-500":"text-gray-700",v=n?"line-through decoration-slate-400 decoration-2 text-slate-600":"text-gray-700",y=`leading-relaxed whitespace-pre-line space-y-2 ${v}`,N=`text-xs ${v}`,w=n?"bg-gray-200 text-gray-500 line-through decoration-slate-400":"bg-gray-100 text-gray-600";return e.jsx("div",{ref:d,className:"fixed inset-0 z-[70] flex items-center justify-center bg-black/60 backdrop-blur-sm px-4",onClick:e=>{e.stopPropagation(),r()},role:"dialog","aria-modal":"true","aria-label":c,onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),r())},tabIndex:-1,children:e.jsxs("div",{className:"bg-white max-w-4xl w-full max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-pink-500 px-6 py-5 text-white flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-orange-100",children:x}),e.jsx("h3",{className:"text-2xl font-bold mt-1",children:c}),e.jsxs("div",{className:"flex items-center gap-3 mt-3",children:[g.badge&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold text-white ${g.badgeColor}`,children:g.badge}),e.jsx("p",{className:"text-sm text-orange-100",children:g.title})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[o&&e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),o()},className:"inline-flex h-9 w-9 items-center justify-center rounded-full border shadow-sm transition "+(n?"border-green-300 bg-white/90 text-green-600":"border-white/60 bg-white/20 text-white/80 hover:bg-white/30"),title:f,"aria-label":f,"aria-pressed":n,children:n?e.jsx(l,{className:"w-5 h-5"}):e.jsx(i,{className:"w-5 h-5"})}),e.jsx("button",{type:"button",onClick:r,className:"text-white/80 hover:text-white text-2xl leading-none","aria-label":b,children:e.jsx("span",{"aria-hidden":"true",children:"×"})})]})]}),e.jsxs("div",{className:"px-6 py-6 space-y-5",children:[g.context&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-xl p-4",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500 mb-1",children:h}),e.jsx("p",{className:`text-sm ${j}`,children:g.context})]}),e.jsx("div",{className:"bg-white border border-gray-200 rounded-xl p-5 shadow-sm",children:e.jsx("div",{className:y,children:(k=g.content,k?k.split(/(\*\*[^*]+\*\*)/g).map((t,s)=>t.startsWith("**")&&t.endsWith("**")?e.jsx("strong",{className:"text-gray-900",children:t.slice(2,-2)},s):t):null)})}),(g.hook||g.mic_drop)&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-4",children:[g.hook&&e.jsxs("div",{className:"bg-orange-50 rounded-xl p-4 border border-orange-200",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-orange-700 mb-1",children:m}),e.jsx("p",{className:N,children:g.hook})]}),g.mic_drop&&e.jsxs("div",{className:"bg-blue-50 rounded-xl p-4 border border-blue-200",children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-blue-700 mb-1",children:u}),e.jsx("p",{className:N,children:g.mic_drop})]})]}),g.tags&&g.tags.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold uppercase tracking-wide text-gray-500 mb-2",children:p}),e.jsx("div",{className:"flex flex-wrap gap-2",children:g.tags.map(t=>e.jsxs("span",{className:`px-2 py-1 rounded text-xs ${w}`,children:["#",t]},t))})]})]})]})});var k}function o({language:o,onClose:d,usedIcebreakers:c={},onToggleUsed:x=()=>{}}){const{t:g}=t(),[h,m]=a.useState(o),u=r[h],[p,b]=a.useState(null),[f,j]=a.useState(null),[v,y]=a.useState(""),N=v.trim().toLowerCase(),w=a.useRef(null);a.useEffect(()=>{var e;f||null==(e=null==w?void 0:w.current)||e.focus()},[f]),a.useEffect(()=>{var e;null==(e=null==w?void 0:w.current)||e.focus()},[]);const k=Object.keys(u).filter(e=>!["title","subtitle","questions"].includes(e)).map(e=>({id:e,data:u[e]})),C=a.useMemo(()=>{if(!N)return[];const e=[];return k.forEach(t=>{var s;((null==(s=t.data)?void 0:s.versions)||[]).forEach(s=>{var a,r,l,i;const n=s.content?s.content.replace(/\*\*[^*]+\*\*/g,""):"";if(![null==(a=t.data)?void 0:a.question,null==(r=t.data)?void 0:r.category,s.title,s.context,n,s.hook,s.mic_drop,Array.isArray(s.tags)?s.tags.join(" "):null].filter(Boolean).join(" ").toLowerCase().includes(N))return;let o=n||s.context||s.hook||s.mic_drop||s.title||"";let d=o.toLowerCase().indexOf(N);-1===d&&(o=(s.context||s.hook||s.mic_drop||s.title||"").toString(),d=o.toLowerCase().indexOf(N));const c=d<0?0:Math.max(0,d-40),x=d<0?Math.min(o.length,120):Math.min(o.length,d+N.length+60);let g=o.slice(c,x).trim();c>0&&(g=`.${g}`),x<o.length&&(g=`${g}.`),e.push({sectionId:t.id,sectionTitle:null==(l=t.data)?void 0:l.question,sectionCategory:null==(i=t.data)?void 0:i.category,version:s,snippet:g})})}),e.slice(0,12)},[N,k]),$=k.map(e=>{if(!N)return e;const t=(e.data.versions||[]).filter(t=>[e.data.question,e.data.category,t.title,t.context,t.content,t.hook,t.mic_drop,Array.isArray(t.tags)?t.tags.join(" "):null].filter(Boolean).join(" ").toLowerCase().includes(N));return t.length>0?{...e,data:{...e.data,versions:t}}:null}).filter(Boolean);a.useEffect(()=>{p&&!$.find(e=>e.id===p)&&b(null)},[p,$]);const I=a.useCallback(()=>{j(null),y(""),b(null),d()},[d]);return e.jsx("div",{ref:w,className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm",onClick:I,role:"dialog","aria-modal":"true","aria-labelledby":"icebreaker-title",onKeyDown:e=>{"Escape"===e.key&&(e.stopPropagation(),f?j(null):I())},tabIndex:-1,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl max-w-[95vw] w-full max-h-[90vh] overflow-hidden mx-4",onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:"bg-gradient-to-r from-orange-500 to-orange-600 px-6 py-4 flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{id:"icebreaker-title",className:"text-2xl font-bold text-white flex items-center gap-2",children:["🧊 ",u.title]}),e.jsx("p",{className:"text-orange-100 text-sm mt-1",children:u.subtitle})]}),e.jsxs("div",{className:"flex w-full flex-wrap items-center gap-3 md:flex-nowrap md:flex-1 md:justify-end",children:[e.jsxs("div",{className:"relative flex-1 basis-full md:basis-auto min-w-[260px] md:max-w-none",children:[e.jsx("input",{type:"text",value:v,onChange:e=>y(e.target.value),placeholder:g("filterNarrativesPlaceholder"),className:"bg-white/15 text-white/90 placeholder:text-white/60 w-full pl-4 pr-10 py-2 rounded-lg border border-white/20 focus:outline-none focus:ring-2 focus:ring-white/60 transition",onClick:e=>e.stopPropagation(),"aria-label":g("filterNarrativesPlaceholder")}),e.jsx("span",{className:"absolute inset-y-0 right-3 flex items-center text-white/70 pointer-events-none",children:"🔍"}),N&&C.length>0&&e.jsx("div",{className:"absolute z-50 mt-2 left-0 right-0 min-w-full md:min-w-[520px] lg:min-w-[680px] max-h-80 overflow-auto rounded-xl border border-white/40 bg-white/95 shadow-xl text-slate-700",children:C.map((t,a)=>{const r=`${h}-${t.sectionId}-${t.version.id}`,l=!!c[r],i=l?"line-through decoration-slate-400 decoration-2 text-slate-500":"text-slate-800",n=l?"line-through decoration-slate-300 text-slate-500":"text-slate-500";return e.jsxs("button",{type:"button",onClick:e=>{e.stopPropagation(),b(t.sectionId),j({sectionId:t.sectionId,sectionTitle:t.sectionTitle,sectionCategory:t.sectionCategory,version:t.version,narrativeId:r})},className:"w-full text-left px-4 py-3 border-b border-white/60 last:border-b-0 hover:bg-white transition "+(l?"bg-white/80":""),children:[e.jsx("p",{className:`text-sm mb-1 leading-snug ${i}`,children:e.jsx(s,{text:t.snippet,searchTerm:v,className:i})}),e.jsxs("p",{className:`text-xs ${n}`,children:[t.sectionTitle," - ",t.version.title]})]},`${t.sectionId}-${t.version.id}-${a}`)})})]}),e.jsxs("button",{onClick:()=>{m(e=>"pt"===e?"en":"pt")},className:"shrink-0 text-white hover:bg-orange-600 rounded-lg px-4 py-2 transition font-semibold flex items-center gap-2","aria-label":"Toggle language",children:["🌐 ",g("languageToggle")]}),e.jsx("button",{onClick:I,className:"shrink-0 text-white hover:bg-orange-600 rounded-lg px-3 py-2 transition text-xl","aria-label":"Close icebreaker modal",children:"?"})]})]}),e.jsx("div",{className:"p-6 overflow-y-auto max-h-[calc(90vh-100px)]",children:e.jsxs("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2",children:[0===$.length&&e.jsx("div",{className:"col-span-1 md:col-span-2 border border-dashed border-orange-300 rounded-xl p-6 text-center text-orange-700 bg-orange-50/60",children:g("noNarrativesFound")}),$.map(t=>{var s,a;const r=t.data,n=p===t.id;return e.jsxs("div",{className:"border-2 border-gray-200 rounded-xl overflow-hidden hover:border-orange-300 transition-all",children:[e.jsx("button",{type:"button",className:"w-full text-left bg-gradient-to-r from-gray-50 to-white px-5 py-4 cursor-pointer",onClick:()=>b(n?null:t.id),"aria-expanded":n,"aria-controls":`section-content-${t.id}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:r.question}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:r.category})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"px-3 py-1 bg-orange-100 text-orange-700 rounded-full text-xs font-semibold",children:[(null==(s=r.versions)?void 0:s.length)||0," ",g("versions")]}),e.jsx("span",{className:"text-2xl transition-transform "+(n?"rotate-180":""),children:"▾"})]})]})}),n&&e.jsx("div",{id:`section-content-${t.id}`,className:"p-5 bg-white border-t border-gray-200",children:e.jsx("div",{className:"grid md:grid-cols-2 gap-4",children:null==(a=r.versions)?void 0:a.map(s=>{const a=g("hookLabel"),n=g("micDropLabel"),o=`${h}-${t.id}-${s.id}`,d=!!c[o],m=g(d?"unmarkUsedNarrative":"markUsedNarrative");return e.jsxs("div",{className:"relative",children:[e.jsx("button",{type:"button",onClick:()=>j({sectionId:t.id,sectionTitle:r.question,sectionCategory:r.category,version:s,narrativeId:o}),className:"w-full text-left border-2 border-gray-200 rounded-lg bg-white hover:border-orange-300 focus:outline-none focus:ring-2 focus:ring-orange-400 transition-all "+(d?"opacity-80":""),title:g("openFullNarrative"),children:e.jsxs("div",{className:"p-4 flex flex-col gap-3",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[s.badge&&e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold text-white ${s.badgeColor}`,children:s.badge}),e.jsx("h4",{className:"text-lg font-bold text-gray-900 "+(d?"line-through decoration-slate-500 text-slate-600":""),children:s.title})]}),s.context&&e.jsx("p",{className:"text-sm text-gray-600 italic "+(d?"line-through decoration-slate-400 text-gray-500":""),children:s.context})]}),e.jsx("span",{className:"text-xl text-orange-500 pr-8","aria-hidden":"true",children:"?"})]}),(s.hook||s.mic_drop)&&e.jsxs("div",{className:"grid md:grid-cols-2 gap-3",children:[s.hook&&e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3",children:[e.jsx("p",{className:"font-bold text-orange-700 text-xs mb-1",children:a}),e.jsx("p",{className:"text-gray-700 text-xs "+(d?"line-through decoration-slate-400 text-gray-600":""),children:s.hook})]}),s.mic_drop&&e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3",children:[e.jsx("p",{className:"font-bold text-blue-700 text-xs mb-1",children:n}),e.jsx("p",{className:"text-gray-700 text-xs "+(d?"line-through decoration-slate-400 text-gray-600":""),children:s.mic_drop})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:s.tags.map(t=>e.jsxs("span",{className:"px-2 py-1 rounded text-xs "+(d?"bg-gray-200 text-gray-500 line-through decoration-slate-400":"bg-gray-100 text-gray-600"),children:["#",t]},t))})]})}),e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),x(o)},className:"absolute top-3 right-3 inline-flex h-7 w-7 items-center justify-center rounded-full bg-white/90 text-slate-500 shadow-sm transition hover:text-green-600 focus:outline-none focus:ring-2 focus:ring-orange-200",title:m,"aria-label":m,"aria-pressed":d,children:d?e.jsx(l,{className:"w-4 h-4"}):e.jsx(i,{className:"w-4 h-4"})})]},s.id)})})})]},t.id)})]})}),e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-t border-gray-200 flex justify-end",children:e.jsx("button",{onClick:I,className:"px-6 py-2 bg-orange-500 text-white rounded-lg hover:bg-orange-600 transition font-semibold",children:g("close")})}),f&&e.jsx(n,{language:h,narrative:f,isUsed:!!c[f.narrativeId||`${h}-${f.sectionId}-${f.version.id}`],onToggleUsed:()=>{const e=f.narrativeId||`${h}-${f.sectionId}-${f.version.id}`;e&&x(e)},onClose:()=>j(null)})]})})}export{o as default};
